<!DOCTYPE html>
<html lang="fa">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
   <link href="https://fonts.googleapis.com/css2?family=Vazirmatn:wght@400;700&display=swap" rel="stylesheet">
  <title>Ù…Ø¯ÛŒØ±ÛŒØª Ø¢Ø¨ Ú©Ø´Ø§ÙˆØ±Ø²ÛŒ Ø¨Ø§ ØªØ­Ù„ÛŒÙ„</title>
  <style>
    body {
      font-family: Tahoma, sans-serif;
      direction: rtl;
      background: #f4f9f9;
      margin: 0;
      padding: 20px;
      color: #2c3e50;
    }
    h1, h2, h3, h4 {
      text-align: center;
      margin-bottom: 15px;
    }
    .container {
      max-width: 900px;
      margin: auto;
      background: white;
      padding: 25px 30px;
      border-radius: 10px;
      box-shadow: 0 0 15px rgba(0,0,0,0.1);
    }
    label {
      display: block;
      margin: 12px 0 6px;
      font-weight: bold;
    }
    input, select, button {
      width: 100%;
      padding: 10px;
      margin-bottom: 15px;
      border-radius: 5px;
      border: 1px solid #ccc;
      font-size: 16px;
      box-sizing: border-box;
      transition: border-color 0.3s ease;
    }
    input:focus, select:focus {
      border-color: #3498db;
      outline: none;
    }
    button {
      background-color: #3498db;
      color: white;
      border: none;
      font-weight: bold;
      cursor: pointer;
      transition: background-color 0.3s ease;
    }
    button:hover {
      background-color: #2980b9;
    }
    .help-text {
      font-size: 12px;
      color: #555;
      margin-top: -10px;
      margin-bottom: 10px;
    }
    .error {
      border-color: crimson !important;
      background-color: #ffe6e6;
    }
    .error-message {
      color: crimson;
      font-size: 12px;
      margin-top: -10px;
      margin-bottom: 10px;
      display: none; /* Initially hidden */
    }
    #result {
      margin-top: 25px;
      background-color: #eaf2f8;
      border-radius: 8px;
      padding: 20px;
      font-size: 16px;
      line-height: 1.5;
      color: #2c3e50;
    }
    #history {
      margin-top: 30px;
      font-size: 14px;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 10px;
    }
    table, th, td {
      border: 1px solid #ccc;
    }
    th, td {
      padding: 8px;
      text-align: center;
    }
    .delete-btn {
      background: crimson;
      color: white;
      border: none;
      border-radius: 5px;
      padding: 5px 10px;
      cursor: pointer;
      font-size: 14px;
    }
    .status-badge {
      font-weight: bold;
      margin-right: 8px;
      padding: 3px 8px;
      border-radius: 15px;
      color: white;
      font-size: 14px;
    }
    .Ø¨Ø§Ù„Ø§ { background-color: #e74c3c; }
    .Ù…ØªÙˆØ³Ø· { background-color: #f39c12; }
    .Ù…Ù†Ø§Ø³Ø¨ { background-color: #27ae60; }
    .progress-bar {
      height: 18px;
      border-radius: 9px;
      background-color: #3498db;
      color: white;
      text-align: center;
      line-height: 18px;
      margin-top: 4px;
      font-size: 13px;
      font-weight: bold;
    }
    .analysis-section ul {
      list-style-type: disc;
      padding-right: 20px;
      margin-top: 0;
      margin-bottom: 15px;
    }
    .analysis-section ul li {
      margin-bottom: 6px;
    }
    .alert-message p {
      margin: 8px 0;
      font-weight: bold;
    }
    .chart-bar {
      background-color: #3498db;
      color: white;
      padding: 8px;
      border-radius: 6px;
      margin-bottom: 6px;
      max-width: 100%;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }
    .chart-average {
      font-size: 14px;
      color: #555;
      text-align: center;
      margin-bottom: 15px;
    }
    @media (max-width: 768px) {
      .container {
        padding: 15px 20px;
      }
      input, select, button {
        font-size: 18px;
        padding: 14px;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>Ø¨Ø±Ù†Ø§Ù…Ù‡ Ù…Ø¯ÛŒØ±ÛŒØª Ø¢Ø¨ Ú©Ø´Ø§ÙˆØ±Ø²ÛŒ Ø¨Ø§ ØªØ­Ù„ÛŒÙ„</h1>
    <form id="waterForm" onsubmit="event.preventDefault(); calculateAndSave();">
      <label for="location">Ù…ÙˆÙ‚Ø¹ÛŒØª Ù…Ø²Ø±Ø¹Ù‡</label>
      <input type="text" id="location" placeholder="Ù…Ø«Ù„Ø§Ù‹ Ú©Ø±Ø¬ ÛŒØ§ 35.8, 50.9" required />
      <small class="help-text">Ù†Ø§Ù… Ø´Ù‡Ø± ÛŒØ§ Ù…Ø®ØªØµØ§Øª Ø¬ØºØ±Ø§ÙÛŒØ§ÛŒÛŒ</small>
      <div class="error-message" id="locationError">Ù„Ø·ÙØ§ Ù…ÙˆÙ‚Ø¹ÛŒØª Ù…Ø²Ø±Ø¹Ù‡ Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯.</div>

      <label for="landArea">Ù…Ø³Ø§Ø­Øª Ø²Ù…ÛŒÙ† (Ù‡Ú©ØªØ§Ø±)</label>
      <input type="number" id="landArea" min="0" step="0.01" placeholder="Ù…Ø«Ù„Ø§Ù‹ 1.5" required />
      <small class="help-text">Ù…Ø³Ø§Ø­Øª Ø²Ù…ÛŒÙ† Ø¨Ù‡ Ù‡Ú©ØªØ§Ø±</small>
      <div class="error-message" id="landAreaError">Ù„Ø·ÙØ§ Ù…Ø³Ø§Ø­Øª Ø²Ù…ÛŒÙ† Ø±Ø§ Ø¨Ù‡ Ø¯Ø±Ø³ØªÛŒ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯.</div>

      <label for="soilDepth">Ø¶Ø®Ø§Ù…Øª Ø®Ø§Ú© (Ù…ÛŒÙ„ÛŒâ€ŒÙ…ØªØ±)</label>
      <input type="number" id="soilDepth" min="0" step="1" placeholder="Ù…Ø«Ù„Ø§Ù‹ 30" required />
      <small class="help-text">Ø¶Ø®Ø§Ù…Øª Ø®Ø§Ú© Ø¨Ù‡ Ù…ÛŒÙ„ÛŒâ€ŒÙ…ØªØ±</small>
      <div class="error-message" id="soilDepthError">Ù„Ø·ÙØ§ Ø¶Ø®Ø§Ù…Øª Ø®Ø§Ú© Ø±Ø§ Ø¨Ù‡ Ø¯Ø±Ø³ØªÛŒ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯.</div>

      <label for="soilType">Ù†ÙˆØ¹ Ø®Ø§Ú©</label>
      <select id="soilType" required>
        <option value="" disabled selected>Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù†ÛŒØ¯</option>
        <option value="1.0">Ø´Ù†ÛŒ (Ø®Ø§Ú© Ø³Ø¨Ú©)</option>
        <option value="1.1">Ù„ÙˆÙ…ÛŒ (Ø®Ø§Ú© Ù…ØªÙˆØ³Ø·)</option>
        <option value="1.2">Ø±Ø³ÛŒ (Ø®Ø§Ú© Ø³Ù†Ú¯ÛŒÙ†)</option>
      </select>
      <div class="error-message" id="soilTypeError">Ù„Ø·ÙØ§ Ù†ÙˆØ¹ Ø®Ø§Ú© Ø±Ø§ Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù†ÛŒØ¯.</div>

      <label for="crop">Ù†ÙˆØ¹ Ú¯ÛŒØ§Ù‡</label>
      <select id="crop" required>
        <option value="" disabled selected>Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù†ÛŒØ¯</option>
        <option value="0.7">Ú¯Ù†Ø¯Ù…</option>
        <option value="1.05">Ø¨Ø±Ù†Ø¬</option>
        <option value="0.85">Ø°Ø±Øª</option>
        <option value="0.95">Ø³ÛŒØ¨â€ŒØ²Ù…ÛŒÙ†ÛŒ</option>
      </select>
      <div class="error-message" id="cropError">Ù„Ø·ÙØ§ Ù†ÙˆØ¹ Ú¯ÛŒØ§Ù‡ Ø±Ø§ Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù†ÛŒØ¯.</div>

      <label for="stage">Ù…Ø±Ø­Ù„Ù‡ Ø±Ø´Ø¯ Ú¯ÛŒØ§Ù‡</label>
      <select id="stage" required>
        <option value="" disabled selected>Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù†ÛŒØ¯</option>
        <option value="1">Ø§ÙˆÙ„ÛŒÙ‡</option>
        <option value="1.1">Ù…ÛŒØ§Ù†ÛŒ</option>
        <option value="1.25">Ù†Ù‡Ø§ÛŒÛŒ</option>
      </select>
      <div class="error-message" id="stageError">Ù„Ø·ÙØ§ Ù…Ø±Ø­Ù„Ù‡ Ø±Ø´Ø¯ Ø±Ø§ Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù†ÛŒØ¯.</div>

      <label for="et0">ETâ‚€ (ØªØ¨Ø®ÛŒØ± Ùˆ ØªØ¹Ø±Ù‚) mm/day</label>
      <input type="number" id="et0" min="0" step="0.01" required />
      <small class="help-text">Ù…Ù‚Ø¯Ø§Ø± ØªØ¨Ø®ÛŒØ± Ùˆ ØªØ¹Ø±Ù‚ Ø±ÙˆØ²Ø§Ù†Ù‡ (Ù…ÛŒÙ„ÛŒÙ…ØªØ±) Ø§Ø² Ø§ÛŒØ³ØªÚ¯Ø§Ù‡ Ù‡ÙˆØ§Ø´Ù†Ø§Ø³ÛŒ</small>
      <div class="error-message" id="et0Error">Ù„Ø·ÙØ§ Ù…Ù‚Ø¯Ø§Ø± ETâ‚€ Ø±Ø§ Ø¨Ù‡ Ø¯Ø±Ø³ØªÛŒ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯.</div>

      <label for="efficiency">Ø±Ø§Ù†Ø¯Ù…Ø§Ù† Ø¢Ø¨ÛŒØ§Ø±ÛŒ (%)</label>
      <input type="number" id="efficiency" min="1" max="100" required />
      <small class="help-text">Ø±Ø§Ù†Ø¯Ù…Ø§Ù† Ø³ÛŒØ³ØªÙ… Ø¢Ø¨ÛŒØ§Ø±ÛŒ Ø¨ÛŒÙ† 1 ØªØ§ 100 Ø¯Ø±ØµØ¯</small>
      <div class="error-message" id="efficiencyError">Ù„Ø·ÙØ§ Ø±Ø§Ù†Ø¯Ù…Ø§Ù† Ø¢Ø¨ÛŒØ§Ø±ÛŒ Ø±Ø§ Ø¨ÛŒÙ† 1 ØªØ§ 100 Ø¯Ø±ØµØ¯ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯.</div>

      <label for="rainfall">Ù…Ù‚Ø¯Ø§Ø± Ø¨Ø§Ø±Ø´ (mm)</label>
      <input type="number" id="rainfall" min="0" step="0.1" required />
      <small class="help-text">Ø¨Ø§Ø±Ø´ Ø±ÙˆØ²Ø§Ù†Ù‡ ÛŒØ§ Ø¯ÙˆØ±Ù‡ Ù…ÙˆØ±Ø¯ Ù†Ø¸Ø±</small>
      <div class="error-message" id="rainfallError">Ù„Ø·ÙØ§ Ù…Ù‚Ø¯Ø§Ø± Ø¨Ø§Ø±Ø´ Ø±Ø§ Ø¨Ù‡ Ø¯Ø±Ø³ØªÛŒ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯.</div>

      <label for="ec">Ø´ÙˆØ±ÛŒ Ø¢Ø¨ (dS/m)</label>
      <input type="number" id="ec" min="0" step="0.01" required />
      <small class="help-text">Ù…ÛŒØ²Ø§Ù† Ø´ÙˆØ±ÛŒ Ø¢Ø¨ Ø¢Ø¨ÛŒØ§Ø±ÛŒ</small>
      <div class="error-message" id="ecError">Ù„Ø·ÙØ§ Ù…Ù‚Ø¯Ø§Ø± Ø´ÙˆØ±ÛŒ Ø¢Ø¨ Ø±Ø§ Ø¨Ù‡ Ø¯Ø±Ø³ØªÛŒ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯.</div>

      <label for="irrigation">Ù†ÙˆØ¹ Ø³ÛŒØ³ØªÙ… Ø¢Ø¨ÛŒØ§Ø±ÛŒ</label>
      <select id="irrigation" required>
        <option value="" disabled selected>Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù†ÛŒØ¯</option>
        <option value="0.9">Ù‚Ø·Ø±Ù‡â€ŒØ§ÛŒ</option>
        <option value="0.75">Ø¨Ø§Ø±Ø§Ù†ÛŒ</option>
        <option value="0.6">ØºØ±Ù‚Ø§Ø¨ÛŒ</option>
      </select>
      <div class="error-message" id="irrigationError">Ù„Ø·ÙØ§ Ù†ÙˆØ¹ Ø³ÛŒØ³ØªÙ… Ø¢Ø¨ÛŒØ§Ø±ÛŒ Ø±Ø§ Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù†ÛŒØ¯.</div>

      <button type="submit">Ù…Ø­Ø§Ø³Ø¨Ù‡ Ùˆ Ø°Ø®ÛŒØ±Ù‡</button>
    </form>

    <div id="result" role="region" aria-live="polite"></div>

    <h2>Ø³ÙˆØ§Ø¨Ù‚ Ù…Ø­Ø§Ø³Ø¨Ù‡</h2>
    <div id="history"></div>
  </div>

  <script>
    // Ø§Ø¹ØªØ¨Ø§Ø±Ø³Ù†Ø¬ÛŒ ÙˆØ±ÙˆØ¯ÛŒâ€ŒÙ‡Ø§ Ø¨Ø§ Ù†Ù…Ø§ÛŒØ´ Ø®Ø·Ø§
    function validateInputs() {
      let isValid = true;
      const inputs = [
        { id: 'location', errorId: 'locationError' },
        { id: 'landArea', errorId: 'landAreaError' },
        { id: 'soilDepth', errorId: 'soilDepthError' },
        { id: 'soilType', errorId: 'soilTypeError' },
        { id: 'crop', errorId: 'cropError' },
        { id: 'stage', errorId: 'stageError' },
        { id: 'et0', errorId: 'et0Error' },
        { id: 'efficiency', errorId: 'efficiencyError' },
        { id: 'rainfall', errorId: 'rainfallError' },
        { id: 'ec', errorId: 'ecError' },
        { id: 'irrigation', errorId: 'irrigationError' },
      ];

      inputs.forEach(({ id, errorId }) => {
        const el = document.getElementById(id);
        const errorEl = document.getElementById(errorId);
        el.classList.remove('error');
        errorEl.style.display = 'none';

        if (!el.value || (el.type === 'number' && (isNaN(el.value) || el.value < 0))) {
          el.classList.add('error');
          errorEl.style.display = 'block';
          isValid = false;
        }
      });

      return isValid;
    }

    function calculateAndSave() {
      if (!validateInputs()) return;

      const data = {
        location: document.getElementById('location').value.trim(),
        landArea: parseFloat(document.getElementById('landArea').value), // Ù…Ø³Ø§Ø­Øª Ø²Ù…ÛŒÙ†
        soilDepth: parseFloat(document.getElementById('soilDepth').value), // Ø¶Ø®Ø§Ù…Øª Ø®Ø§Ú©
        soilFactor: parseFloat(document.getElementById('soilType').value),
        cropFactor: parseFloat(document.getElementById('crop').value),
        stageFactor: parseFloat(document.getElementById('stage').value),
        et0: parseFloat(document.getElementById('et0').value),
        efficiency: parseFloat(document.getElementById('efficiency').value),
        rainfall: parseFloat(document.getElementById('rainfall').value),
        ec: parseFloat(document.getElementById('ec').value),
        irrigationFactor: parseFloat(document.getElementById('irrigation').value),
        date: new Date().toLocaleDateString('fa-IR')
      };

      // Ù…Ø­Ø§Ø³Ø¨Ù‡ kc Ùˆ Ù†ÛŒØ§Ø² Ø¢Ø¨ÛŒ
      const kc = data.cropFactor * data.stageFactor * data.soilFactor;
      let waterNeed = (data.et0 * kc) / (data.efficiency / 100);
      waterNeed = Math.max(waterNeed - data.rainfall, 0);

      // Ù…Ø­Ø§Ø³Ø¨Ù‡ Ù†ÛŒØ§Ø² Ø¢Ø¨ÛŒ Ø¨Ø± Ø§Ø³Ø§Ø³ Ù…Ø³Ø§Ø­Øª Ùˆ Ø¶Ø®Ø§Ù…Øª Ø®Ø§Ú©
      const areaInSquareMeters = data.landArea * 10000; // ØªØ¨Ø¯ÛŒÙ„ Ù‡Ú©ØªØ§Ø± Ø¨Ù‡ Ù…ØªØ± Ù…Ø±Ø¨Ø¹
      const totalWaterNeed = waterNeed * areaInSquareMeters; // Ù†ÛŒØ§Ø² Ø¢Ø¨ÛŒ Ú©Ù„ Ø¨Ù‡ Ù…ÛŒÙ„ÛŒâ€ŒÙ…ØªØ±
      const totalWaterVolume = (totalWaterNeed * data.soilDepth) / 1000; // Ø­Ø¬Ù… Ø¢Ø¨ Ø¨Ù‡ Ù„ÛŒØªØ± (ØªØ¨Ø¯ÛŒÙ„ Ù…ÛŒÙ„ÛŒâ€ŒÙ…ØªØ± Ø¨Ù‡ Ù…ØªØ±)

      data.waterNeed = waterNeed.toFixed(2);
      data.totalWaterNeed = totalWaterNeed.toFixed(2);
      data.totalWaterVolume = totalWaterVolume.toFixed(2);

      // Ù¾ÛŒØ§Ù… Ø´ÙˆØ±ÛŒ Ø¢Ø¨
      let ecMsg = data.ec > 3 ? 'Ø´ÙˆØ±ÛŒ Ø²ÛŒØ§Ø¯ - Ø®Ø·Ø±Ù†Ø§Ú©' : data.ec > 1.7 ? 'Ø´ÙˆØ±ÛŒ Ù…ØªÙˆØ³Ø· - Ø¨Ø§Ø§Ø­ØªÛŒØ§Ø·' : 'Ø´ÙˆØ±ÛŒ Ù…Ù†Ø§Ø³Ø¨';
      data.ecMessage = ecMsg;

      // Ù‡Ø´Ø¯Ø§Ø±Ù‡Ø§ Ùˆ ØªÙˆØµÛŒÙ‡â€ŒÙ‡Ø§
      data.warnings = [];
      if (data.ec > 3) {
        data.warnings.push('âš ï¸ Ø´ÙˆØ±ÛŒ Ø¢Ø¨ Ø¨Ø³ÛŒØ§Ø± Ø¨Ø§Ù„Ø§ Ø§Ø³Øª. Ù…Ù…Ú©Ù† Ø§Ø³Øª Ù†ÛŒØ§Ø² Ø¨Ù‡ ØªØºÛŒÛŒØ± Ù…Ù†Ø§Ø¨Ø¹ Ø¢Ø¨ Ø¯Ø§Ø´ØªÙ‡ Ø¨Ø§Ø´ÛŒØ¯.');
      }
      if (data.rainfall > 10) {
        data.warnings.push('â˜” Ø¨Ø§Ø±Ø´ Ù‚Ø§Ø¨Ù„ ØªÙˆØ¬Ù‡ÛŒ ÙˆØ¬ÙˆØ¯ Ø¯Ø§Ø±Ø¯. Ù…ÛŒâ€ŒØªÙˆØ§Ù†ÛŒØ¯ Ø§Ø² Ø¢Ø¨ÛŒØ§Ø±ÛŒ Ú©Ù…ØªØ±ÛŒ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†ÛŒØ¯.');
      }

      showResult(data);
      saveData(data);
      renderHistory();

      // Ù¾Ø§Ú© Ú©Ø±Ø¯Ù† ÙØ±Ù… Ø¨Ø¹Ø¯ Ø§Ø² Ø«Ø¨Øª
      document.getElementById('waterForm').reset();
      renderHistory(); // Refresh history
    }

    function showResult(data) {
      document.getElementById('result').innerHTML = `
        <div class="analysis-section">
          <h3>ğŸ“Š ØªØ­Ù„ÛŒÙ„ Ú©Ø§Ù…Ù„ ÙˆØ¶Ø¹ÛŒØª Ø¢Ø¨ÛŒØ§Ø±ÛŒ</h3>
          <div class="stats-box" style="margin-bottom:15px;">
            <div class="stat-item" style="margin-bottom:8px;">
              <span class="stat-label" style="font-weight:bold;">Ù†ÛŒØ§Ø² Ø¢Ø¨ÛŒ Ø±ÙˆØ²Ø§Ù†Ù‡:</span>
              <span class="stat-value" style="margin-right:10px;">${data.waterNeed} Ù…ÛŒÙ„ÛŒâ€ŒÙ…ØªØ±</span>
              ${getWaterNeedStatus(data.waterNeed)}
            </div>
            <div class="stat-item">
              <span class="stat-label" style="font-weight:bold;">Ù†ÛŒØ§Ø² Ø¢Ø¨ÛŒ Ú©Ù„:</span>
              <span class="stat-value" style="margin-right:10px;">${data.totalWaterNeed} Ù…ÛŒÙ„ÛŒâ€ŒÙ…ØªØ±</span>
            </div>
            <div class="stat-item">
              <span class="stat-label" style="font-weight:bold;">Ø­Ø¬Ù… Ø¢Ø¨ Ù„Ø§Ø²Ù…:</span>
              <span class="stat-value" style="margin-right:10px;">${data.totalWaterVolume} Ù„ÛŒØªØ±</span>
            </div>
            <div class="stat-item">
              <span class="stat-label" style="font-weight:bold;">Ø¨Ù‡Ø±Ù‡â€ŒÙˆØ±ÛŒ Ø³ÛŒØ³ØªÙ… Ø¢Ø¨ÛŒØ§Ø±ÛŒ:</span>
              <span class="stat-value" style="margin-right:10px;">${data.efficiency}%</span>
              ${getEfficiencyStatus(data.efficiency)}
            </div>
          </div>
          <div class="factor-breakdown" style="margin-bottom:15px;">
            <h4>ğŸ” Ø¹ÙˆØ§Ù…Ù„ Ù…Ø¤Ø«Ø± Ø¯Ø± Ù…Ø­Ø§Ø³Ø¨Ù‡:</h4>
            <ul>
              <li>Ø¶Ø±ÛŒØ¨ Ú¯ÛŒØ§Ù‡: ${data.cropFactor}</li>
              <li>Ù…Ø±Ø­Ù„Ù‡ Ø±Ø´Ø¯: ${data.stageFactor}x</li>
              <li>Ù†ÙˆØ¹ Ø®Ø§Ú©: ${data.soilFactor}x</li>
              <li>Ø¶Ø±ÛŒØ¨ Ø³ÛŒØ³ØªÙ… Ø¢Ø¨ÛŒØ§Ø±ÛŒ: ${data.irrigationFactor}x</li>
            </ul>
          </div>
          <div class="alert-message" style="margin-bottom:15px;">
            <h4>ğŸš¨ Ù‡Ø´Ø¯Ø§Ø±Ù‡Ø§ Ùˆ ØªÙˆØµÛŒÙ‡â€ŒÙ‡Ø§:</h4>
            ${data.warnings.map(warning => `<p>${warning}</p>`).join('')}
          </div>
          <div class="comparison-chart">
            <h4>ğŸ“ˆ Ù…Ù‚Ø§ÛŒØ³Ù‡ Ø¨Ø§ Ù…ÛŒØ§Ù†Ú¯ÛŒÙ† Ù…Ù†Ø·Ù‚Ù‡</h4>
            <div class="chart-bar" style="width: ${Math.min(data.waterNeed, 15) * 6.5}%; max-width: 100%;">
              Ù†ÛŒØ§Ø² Ø´Ù…Ø§: ${data.waterNeed} Ù…ÛŒÙ„ÛŒâ€ŒÙ…ØªØ±
            </div>
            <div class="chart-average">Ù…ÛŒØ§Ù†Ú¯ÛŒÙ† Ù…Ù†Ø·Ù‚Ù‡: 8.2 Ù…ÛŒÙ„ÛŒâ€ŒÙ…ØªØ±</div>
          </div>
        </div>
      `;
    }

    function getWaterNeedStatus(value) {
      if (value > 10) return `<span class="status-badge Ø¨Ø§Ù„Ø§">Ù†ÛŒØ§Ø² Ø¢Ø¨ÛŒ Ø¨Ø§Ù„Ø§</span>`;
      if (value > 5) return `<span class="status-badge Ù…ØªÙˆØ³Ø·">Ù†ÛŒØ§Ø² Ø¢Ø¨ÛŒ Ù…ØªÙˆØ³Ø·</span>`;
      return `<span class="status-badge Ù…Ù†Ø§Ø³Ø¨">Ù†ÛŒØ§Ø² Ø¢Ø¨ÛŒ Ù…Ù†Ø§Ø³Ø¨</span>`;
    }

    function getEfficiencyStatus(value) {
      if (value > 85) return `<div class="progress-bar" style="width:100%; background-color:#27ae60;">Ø¹Ø§Ù„ÛŒ</div>`;
      if (value > 60) return `<div class="progress-bar" style="width:70%; background-color:#f39c12;">Ù‚Ø§Ø¨Ù„ Ù‚Ø¨ÙˆÙ„</div>`;
      return `<div class="progress-bar" style="width:40%; background-color:#e74c3c;">Ù†ÛŒØ§Ø² Ø¨Ù‡ Ø¨Ù‡Ø¨ÙˆØ¯</div>`;
    }

    function saveData(data) {
      let records = JSON.parse(localStorage.getItem('waterRecords')) || [];
      records.push(data);
      localStorage.setItem('waterRecords', JSON.stringify(records));
    }

    function renderHistory() {
      let records = JSON.parse(localStorage.getItem('waterRecords')) || [];
      if (records.length === 0) {
        document.getElementById('history').innerHTML = 'Ø±Ú©ÙˆØ±Ø¯ÛŒ ÙˆØ¬ÙˆØ¯ Ù†Ø¯Ø§Ø±Ø¯.';
        return;
      }
      let html = `<table><thead><tr><th>ØªØ§Ø±ÛŒØ®</th><th>Ù…Ø²Ø±Ø¹Ù‡</th><th>Ù†ÛŒØ§Ø² Ø¢Ø¨ÛŒ (mm/day)</th><th>Ø­Ø¬Ù… Ø¢Ø¨ (Ù„ÛŒØªØ±)</th><th>Ø´ÙˆØ±ÛŒ</th><th>Ø­Ø°Ù</th></tr></thead><tbody>`;
      records.forEach((rec, index) => {
        html += `<tr>
          <td>${rec.date}</td>
          <td>${rec.location}</td>
          <td>${rec.waterNeed}</td>
          <td>${rec.totalWaterVolume}</td>
          <td>${rec.ecMessage}</td>
          <td><button class="delete-btn" onclick="deleteRecord(${index})">Ø­Ø°Ù</button></td>
        </tr>`;
      });
      html += `</tbody></table>`;
      document.getElementById('history').innerHTML = html;
    }

    function deleteRecord(index) {
      let records = JSON.parse(localStorage.getItem('waterRecords')) || [];
      records.splice(index, 1);
      localStorage.setItem('waterRecords', JSON.stringify(records));
      renderHistory();
    }

    window.onload = renderHistory;
  </script>
</body>
</html>