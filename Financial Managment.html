<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù…Ø¯ÛŒØ±ÛŒØª Ù…Ø§Ù„ÛŒ Ù‡ÙˆØ´Ù…Ù†Ø¯ Ú©Ø´Ø§ÙˆØ±Ø²ÛŒ</title>
    <style>
        /* ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ø¹Ù…ÙˆÙ…ÛŒ */
        :root {
            --primary: #4CAF50;
            --primary-light: #66BB6A;
            --background: #F5F5F5;
            --card: #FFFFFF;
            --text: #1A1A1A;
            --text-secondary: #4A4A4A;
            --shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
            --border: #E0E0E0;
            --dark-bg: #121212;
            --dark-card: #1E1E1E;
            --dark-text: #E0E0E0;
            --dark-border: #333;
        }

        body {
            font-family: 'Vazir', -apple-system, sans-serif;
            margin: 0;
            padding: 20px;
            background: var(--background);
            color: var(--text);
            transition: all 0.3s ease;
            line-height: 1.6;
        }

        body.dark-mode {
            background: var(--dark-bg);
            color: var(--dark-text);
        }

        body.dark-mode .container, body.dark-mode .dashboard, body.dark-mode .tabcontent {
            background: var(--dark-card);
            border-color: var(--dark-border);
        }

        body.dark-mode input, body.dark-mode select {
            background: #2C2C2C;
            color: var(--dark-text);
            border-color: var(--dark-border);
        }

        .container {
            max-width: 1000px;
            margin: 0 auto;
            background: var(--card);
            padding: 30px;
            border-radius: 20px;
            box-shadow: var(--shadow);
            animation: fadeIn 0.5s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        h1 {
            text-align: center;
            font-size: 32px;
            font-weight: 700;
            color: var(--primary);
            margin: 0 0 20px;
        }

        .dashboard {
            background: linear-gradient(135deg, #e8f5e9, #f1f8e9);
            padding: 20px;
            border-radius: 15px;
            margin-bottom: 20px;
            text-align: center;
            box-shadow: var(--shadow);
        }

        .dashboard p {
            margin: 5px 0;
            font-size: 16px;
            color: var(--text-secondary);
        }

        .tab {
            display: flex;
            background: var(--card);
            border-radius: 15px 15px 0 0;
            overflow: hidden;
            margin-bottom: 10px;
            box-shadow: var(--shadow);
        }

        .tab button {
            flex: 1;
            padding: 15px;
            background: none;
            border: none;
            cursor: pointer;
            font-size: 16px;
            font-weight: 500;
            color: var(--text-secondary);
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .tab button:hover, .tab button.active {
            background: var(--primary);
            color: #FFFFFF;
        }

        .tabcontent {
            padding: 25px;
            border: 1px solid var(--border);
            border-top: none;
            border-radius: 0 0 15px 15px;
            background: var(--card);
            animation: fadeIn 0.3s ease;
        }

        .form-group {
            margin-bottom: 20px;
            position: relative;
        }

        label {
            display: block;
            font-weight: 500;
            color: var(--text);
            margin-bottom: 8px;
        }

        select, input[type="text"], input[type="number"], input[type="date"], input[type="checkbox"] {
            width: 100%;
            padding: 12px;
            border: 1px solid var(--border);
            border-radius: 10px;
            font-size: 16px;
            background: var(--card);
            color: var(--text);
            transition: border-color 0.3s, box-shadow 0.3s;
        }

        select:focus, input:focus {
            border-color: var(--primary);
            box-shadow: 0 0 5px rgba(76, 175, 80, 0.3);
            outline: none;
        }

        .tooltip {
            position: absolute;
            top: -30px;
            left: 10px;
            background: var(--primary);
            color: #FFFFFF;
            padding: 5px 10px;
            border-radius: 5px;
            font-size: 12px;
            display: none;
            z-index: 10;
        }

        .form-group:hover .tooltip {
            display: block;
        }

        button.submit-btn, button.report-btn {
            background: linear-gradient(90deg, var(--primary), var(--primary-light));
            color: #FFFFFF;
            padding: 14px;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 500;
            width: 100%;
            transition: transform 0.2s, box-shadow 0.2s;
            margin-top: 10px;
        }

        button.submit-btn:hover, button.report-btn:hover {
            transform: scale(1.02);
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
        }

        #result, #history {
            margin-top: 20px;
            padding: 20px;
            border-radius: 10px;
            background: var(--card);
            border: 1px solid var(--border);
        }

        .history-item {
            padding: 15px;
            border-bottom: 1px solid var(--border);
            transition: background 0.2s;
        }

        .history-item:hover {
            background: #f1f8e9;
        }

        .loader {
            display: none;
            text-align: center;
            padding: 15px;
            color: var(--primary);
            font-weight: 500;
        }

        #chart-container {
            margin-top: 20px;
            padding: 20px;
            border-radius: 10px;
            background: var(--card);
        }

        .theme-toggle {
            position: fixed;
            top: 20px;
            left: 20px;
            background: var(--primary);
            color: #FFFFFF;
            border: none;
            padding: 10px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 18px;
            box-shadow: var(--shadow);
        }

        @media (max-width: 600px) {
            .container {
                padding: 15px;
            }
            h1 {
                font-size: 24px;
            }
            .tab button {
                font-size: 14px;
                padding: 10px;
            }
        }
    </style>
</head>
<body>
    <button class="theme-toggle" onclick="toggleDarkMode()">ğŸŒ™</button>
    <div class="container">
        <h1>Ù…Ø¯ÛŒØ±ÛŒØª Ù…Ø§Ù„ÛŒ Ù‡ÙˆØ´Ù…Ù†Ø¯ Ú©Ø´Ø§ÙˆØ±Ø²ÛŒ</h1>
        <div class="dashboard">
            <h3>Ø®Ù„Ø§ØµÙ‡ ÙˆØ¶Ø¹ÛŒØª Ù…Ø§Ù„ÛŒ</h3>
            <p id="dashboard-profit">Ø³ÙˆØ¯/Ø²ÛŒØ§Ù†: 0 Ø±ÛŒØ§Ù„</p>
            <p id="dashboard-cashflow">Ø¬Ø±ÛŒØ§Ù† Ù†Ù‚Ø¯ÛŒ Ø®Ø§Ù„Øµ: 0 Ø±ÛŒØ§Ù„</p>
            <p id="dashboard-inventory">Ù…ÙˆØ¬ÙˆØ¯ÛŒ Ú©Ù„: 0</p>
        </div>
        <div class="tab">
            <button class="tablinks active" onclick="openTab(event, 'income')">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M12 2v20m10-10H2"/>
                </svg>
                Ø¯Ø±Ø¢Ù…Ø¯
            </button>
            <button class="tablinks" onclick="openTab(event, 'expense')">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M22 12H2"/>
                </svg>
                Ù‡Ø²ÛŒÙ†Ù‡
            </button>
            <button class="tablinks" onclick="openTab(event, 'inventory')">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M20 6H4v12h16V6z"/>
                </svg>
                Ù…ÙˆØ¬ÙˆØ¯ÛŒ
            </button>
            <button class="tablinks" onclick="openTab(event, 'debt')">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M12 2v4m0 12v4m-6-10h12"/>
                </svg>
                ÙˆØ§Ù…
            </button>
            <button class="tablinks" onclick="openTab(event, 'reports')">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M9 17v-6m6 6v-9m-6 9H5a2 2 0 01-2-2V5a2 2 0 012-2h14a2 2 0 012 2v10a2 2 0 01-2 2h-4"/>
                </svg>
                Ú¯Ø²Ø§Ø±Ø´â€ŒÙ‡Ø§
            </button>
            <button class="tablinks" onclick="openTab(event, 'calendar')">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M19 4H5a2 2 0 00-2 2v14a2 2 0 002 2h14a2 2 0 002-2V6a2 2 0 00-2-2zM16 2v4M8 2v4M3 10h18"/>
                </svg>
                ØªÙ‚ÙˆÛŒÙ…
            </button>
        </div>

        <!-- ÙØ±Ù… Ø¯Ø±Ø¢Ù…Ø¯ -->
        <div id="income" class="tabcontent" style="display: block;">
            <div class="form-group">
                <label for="income-source">Ù…Ù†Ø¨Ø¹ Ø¯Ø±Ø¢Ù…Ø¯ (Ø§Ø¬Ø¨Ø§Ø±ÛŒ):</label>
                <span class="tooltip">Ù…Ù†Ø¨Ø¹ Ø¯Ø±Ø¢Ù…Ø¯ Ù…Ø«Ù„ ÙØ±ÙˆØ´ Ù…Ø­ØµÙˆÙ„ ÛŒØ§ ÛŒØ§Ø±Ø§Ù†Ù‡</span>
                <select id="income-source" required>
                    <option value="">Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù†ÛŒØ¯</option>
                    <option value="ÙØ±ÙˆØ´ Ú¯Ù†Ø¯Ù…">ÙØ±ÙˆØ´ Ú¯Ù†Ø¯Ù…</option>
                    <option value="ÙØ±ÙˆØ´ Ú¯ÙˆØ¬Ù‡â€ŒÙØ±Ù†Ú¯ÛŒ">ÙØ±ÙˆØ´ Ú¯ÙˆØ¬Ù‡â€ŒÙØ±Ù†Ú¯ÛŒ</option>
                    <option value="ÙØ±ÙˆØ´ Ø²Ø¹ÙØ±Ø§Ù†">ÙØ±ÙˆØ´ Ø²Ø¹ÙØ±Ø§Ù†</option>
                    <option value="ÙØ±ÙˆØ´ Ø®ÛŒØ§Ø±">ÙØ±ÙˆØ´ Ø®ÛŒØ§Ø±</option>
                    <option value="ÙØ±ÙˆØ´ Ù¾Ø³ØªÙ‡">ÙØ±ÙˆØ´ Ù¾Ø³ØªÙ‡</option>
                    <option value="ÙØ±ÙˆØ´ Ø¨Ø±Ù†Ø¬">ÙØ±ÙˆØ´ Ø¨Ø±Ù†Ø¬</option>
                    <option value="ÛŒØ§Ø±Ø§Ù†Ù‡ Ø¯ÙˆÙ„ØªÛŒ">ÛŒØ§Ø±Ø§Ù†Ù‡ Ø¯ÙˆÙ„ØªÛŒ</option>
                    <option value="Ø³Ø§ÛŒØ±">Ø³Ø§ÛŒØ±</option>
                </select>
            </div>
            <div class="form-group">
                <label for="income-product">Ù…Ø­ØµÙˆÙ„ Ù…Ø±ØªØ¨Ø· (Ø§Ø®ØªÛŒØ§Ø±ÛŒ):</label>
                <span class="tooltip">Ù…Ø­ØµÙˆÙ„ Ù…Ø±ØªØ¨Ø· Ø¨Ø§ Ø¯Ø±Ø¢Ù…Ø¯</span>
                <select id="income-product">
                    <option value="">Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù†ÛŒØ¯</option>
                    <option value="Ú¯Ù†Ø¯Ù…">Ú¯Ù†Ø¯Ù…</option>
                    <option value="Ú¯ÙˆØ¬Ù‡â€ŒÙØ±Ù†Ú¯ÛŒ">Ú¯ÙˆØ¬Ù‡â€ŒÙØ±Ù†Ú¯ÛŒ</option>
                    <option value="Ø²Ø¹ÙØ±Ø§Ù†">Ø²Ø¹ÙØ±Ø§Ù†</option>
                    <option value="Ø®ÛŒØ§Ø±">Ø®ÛŒØ§Ø±</option>
                    <option value="Ù¾Ø³ØªÙ‡">Ù¾Ø³ØªÙ‡</option>
                    <option value="Ø¨Ø±Ù†Ø¬">Ø¨Ø±Ù†Ø¬</option>
                </select>
            </div>
            <div class="form-group">
                <label for="income-amount">Ù…Ø¨Ù„Øº (Ø±ÛŒØ§Ù„ØŒ Ø§Ø¬Ø¨Ø§Ø±ÛŒ):</label>
                <span class="tooltip">Ù…Ø¨Ù„Øº Ø¯Ø±Ø¢Ù…Ø¯</span>
                <input type="number" id="income-amount" min="0" placeholder="Ù…Ø«Ø§Ù„: 5000000" required>
            </div>
            <div class="form-group">
                <label for="income-date">ØªØ§Ø±ÛŒØ® (Ø§Ø®ØªÛŒØ§Ø±ÛŒ):</label>
                <span class="tooltip">ØªØ§Ø±ÛŒØ® Ø¯Ø±ÛŒØ§ÙØª Ø¯Ø±Ø¢Ù…Ø¯</span>
                <input type="date" id="income-date">
            </div>
            <div class="form-group">
                <label for="income-recurring">ØªÚ©Ø±Ø§Ø±Ø´ÙˆÙ†Ø¯Ù‡ØŸ (Ø§Ø®ØªÛŒØ§Ø±ÛŒ):</label>
                <span class="tooltip">Ø¯Ø±Ø¢Ù…Ø¯ Ù…Ø§Ù‡Ø§Ù†Ù‡ ÛŒØ§ Ø¯ÙˆØ±Ù‡â€ŒØ§ÛŒ</span>
                <input type="checkbox" id="income-recurring"> Ù…Ø§Ù‡Ø§Ù†Ù‡
            </div>
            <div class="form-group">
                <label for="income-notes">ÛŒØ§Ø¯Ø¯Ø§Ø´Øª (Ø§Ø®ØªÛŒØ§Ø±ÛŒ):</label>
                <span class="tooltip">ØªÙˆØ¶ÛŒØ­Ø§Øª Ø§Ø¶Ø§ÙÛŒ Ù…Ø«Ù„ Ø®Ø±ÛŒØ¯Ø§Ø±</span>
                <input type="text" id="income-notes" placeholder="Ù…Ø«Ø§Ù„: ÙØ±ÙˆØ´ Ø¨Ù‡ ØªØ¹Ø§ÙˆÙ†ÛŒ">
            </div>
            <button class="submit-btn" onclick="submitIncome()">Ø«Ø¨Øª Ø¯Ø±Ø¢Ù…Ø¯</button>
        </div>

        <!-- ÙØ±Ù… Ù‡Ø²ÛŒÙ†Ù‡ -->
        <div id="expense" class="tabcontent">
            <div class="form-group">
                <label for="expense-type">Ù†ÙˆØ¹ Ù‡Ø²ÛŒÙ†Ù‡ (Ø§Ø¬Ø¨Ø§Ø±ÛŒ):</label>
                <span class="tooltip">Ù†ÙˆØ¹ Ù‡Ø²ÛŒÙ†Ù‡ Ù…Ø«Ù„ Ú©ÙˆØ¯ ÛŒØ§ Ù†ÛŒØ±ÙˆÛŒ Ú©Ø§Ø±</span>
                <select id="expense-type" required>
                    <option value="">Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù†ÛŒØ¯</option>
                    <option value="Ú©ÙˆØ¯">Ú©ÙˆØ¯</option>
                    <option value="Ø³Ù…">Ø³Ù…</option>
                    <option value="Ù†ÛŒØ±ÙˆÛŒ Ú©Ø§Ø±">Ù†ÛŒØ±ÙˆÛŒ Ú©Ø§Ø±</option>
                    <option value="Ù…Ø§Ø´ÛŒÙ†â€ŒØ¢Ù„Ø§Øª">Ù…Ø§Ø´ÛŒÙ†â€ŒØ¢Ù„Ø§Øª</option>
                    <option value="Ø¢Ø¨ÛŒØ§Ø±ÛŒ">Ø¢Ø¨ÛŒØ§Ø±ÛŒ</option>
                    <option value="Ù…Ø§Ù„ÛŒØ§Øª">Ù…Ø§Ù„ÛŒØ§Øª</option>
                    <option value="Ø³Ø§ÛŒØ±">Ø³Ø§ÛŒØ±</option>
                </select>
            </div>
            <div class="form-group">
                <label for="expense-product">Ù…Ø­ØµÙˆÙ„ Ù…Ø±ØªØ¨Ø· (Ø§Ø®ØªÛŒØ§Ø±ÛŒ):</label>
                <span class="tooltip">Ù…Ø­ØµÙˆÙ„ Ù…Ø±ØªØ¨Ø· Ø¨Ø§ Ù‡Ø²ÛŒÙ†Ù‡</span>
                <select id="expense-product">
                    <option value="">Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù†ÛŒØ¯</option>
                    <option value="Ú¯Ù†Ø¯Ù…">Ú¯Ù†Ø¯Ù…</option>
                    <option value="Ú¯ÙˆØ¬Ù‡â€ŒÙØ±Ù†Ú¯ÛŒ">Ú¯ÙˆØ¬Ù‡â€ŒÙØ±Ù†Ú¯ÛŒ</option>
                    <option value="Ø²Ø¹ÙØ±Ø§Ù†">Ø²Ø¹ÙØ±Ø§Ù†</option>
                    <option value="Ø®ÛŒØ§Ø±">Ø®ÛŒØ§Ø±</option>
                    <option value="Ù¾Ø³ØªÙ‡">Ù¾Ø³ØªÙ‡</option>
                    <option value="Ø¨Ø±Ù†Ø¬">Ø¨Ø±Ù†Ø¬</option>
                </select>
            </div>
            <div class="form-group">
                <label for="expense-amount">Ù…Ø¨Ù„Øº (Ø±ÛŒØ§Ù„ØŒ Ø§Ø¬Ø¨Ø§Ø±ÛŒ):</label>
                <span class="tooltip">Ù…Ø¨Ù„Øº Ù‡Ø²ÛŒÙ†Ù‡</span>
                <input type="number" id="expense-amount" min="0" placeholder="Ù…Ø«Ø§Ù„: 2000000" required>
            </div>
            <div class="form-group">
                <label for="expense-date">ØªØ§Ø±ÛŒØ® (Ø§Ø®ØªÛŒØ§Ø±ÛŒ):</label>
                <span class="tooltip">ØªØ§Ø±ÛŒØ® Ù¾Ø±Ø¯Ø§Ø®Øª Ù‡Ø²ÛŒÙ†Ù‡</span>
                <input type="date" id="expense-date">
            </div>
            <div class="form-group">
                <label for="expense-recurring">ØªÚ©Ø±Ø§Ø±Ø´ÙˆÙ†Ø¯Ù‡ØŸ (Ø§Ø®ØªÛŒØ§Ø±ÛŒ):</label>
                <span class="tooltip">Ù‡Ø²ÛŒÙ†Ù‡ Ù…Ø§Ù‡Ø§Ù†Ù‡ ÛŒØ§ Ø¯ÙˆØ±Ù‡â€ŒØ§ÛŒ</span>
                <input type="checkbox" id="expense-recurring"> Ù…Ø§Ù‡Ø§Ù†Ù‡
            </div>
            <div class="form-group">
                <label for="expense-notes">ÛŒØ§Ø¯Ø¯Ø§Ø´Øª (Ø§Ø®ØªÛŒØ§Ø±ÛŒ):</label>
                <span class="tooltip">ØªÙˆØ¶ÛŒØ­Ø§Øª Ø§Ø¶Ø§ÙÛŒ Ù…Ø«Ù„ ÙØ±ÙˆØ´Ù†Ø¯Ù‡</span>
                <input type="text" id="expense-notes" placeholder="Ù…Ø«Ø§Ù„: Ø®Ø±ÛŒØ¯ Ú©ÙˆØ¯ Ø§Ø² Ø´Ø±Ú©Øª X">
            </div>
            <button class="submit-btn" onclick="submitExpense()">Ø«Ø¨Øª Ù‡Ø²ÛŒÙ†Ù‡</button>
        </div>

        <!-- ÙØ±Ù… Ù…ÙˆØ¬ÙˆØ¯ÛŒ -->
        <div id="inventory" class="tabcontent">
            <div class="form-group">
                <label for="inventory-type">Ù†ÙˆØ¹ Ù…ÙˆØ¬ÙˆØ¯ÛŒ (Ø§Ø¬Ø¨Ø§Ø±ÛŒ):</label>
                <span class="tooltip">Ù†ÙˆØ¹ Ù…ÙˆØ¬ÙˆØ¯ÛŒ Ù…Ø«Ù„ Ù…Ø­ØµÙˆÙ„ ÛŒØ§ ØªØ¬Ù‡ÛŒØ²Ø§Øª</span>
                <select id="inventory-type" required>
                    <option value="">Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù†ÛŒØ¯</option>
                    <option value="Ú¯Ù†Ø¯Ù…">Ú¯Ù†Ø¯Ù…</option>
                    <option value="Ú¯ÙˆØ¬Ù‡â€ŒÙØ±Ù†Ú¯ÛŒ">Ú¯ÙˆØ¬Ù‡â€ŒÙØ±Ù†Ú¯ÛŒ</option>
                    <option value="Ø²Ø¹ÙØ±Ø§Ù†">Ø²Ø¹ÙØ±Ø§Ù†</option>
                    <option value="Ú©ÙˆØ¯">Ú©ÙˆØ¯</option>
                    <option value="Ù…Ø§Ø´ÛŒÙ†â€ŒØ¢Ù„Ø§Øª">Ù…Ø§Ø´ÛŒÙ†â€ŒØ¢Ù„Ø§Øª</option>
                </select>
            </div>
            <div class="form-group">
                <label for="inventory-quantity">Ù…Ù‚Ø¯Ø§Ø± (Ø§Ø¬Ø¨Ø§Ø±ÛŒ):</label>
                <span class="tooltip">Ù…Ù‚Ø¯Ø§Ø± Ù…ÙˆØ¬ÙˆØ¯ÛŒ (Ù…Ø«Ù„ Ú©ÛŒÙ„ÙˆÚ¯Ø±Ù…)</span>
                <input type="number" id="inventory-quantity" min="0" placeholder="Ù…Ø«Ø§Ù„: 1000" required>
            </div>
            <div class="form-group">
                <label for="inventory-unit">ÙˆØ§Ø­Ø¯ (Ø§Ø®ØªÛŒØ§Ø±ÛŒ):</label>
                <span class="tooltip">ÙˆØ§Ø­Ø¯ Ù…Ø«Ù„ Ú©ÛŒÙ„ÙˆÚ¯Ø±Ù… ÛŒØ§ Ø¹Ø¯Ø¯</span>
                <input type="text" id="inventory-unit" placeholder="Ù…Ø«Ø§Ù„: Ú©ÛŒÙ„ÙˆÚ¯Ø±Ù…">
            </div>
            <div class="form-group">
                <label for="inventory-notes">ÛŒØ§Ø¯Ø¯Ø§Ø´Øª (Ø§Ø®ØªÛŒØ§Ø±ÛŒ):</label>
                <span class="tooltip">ØªÙˆØ¶ÛŒØ­Ø§Øª Ù…Ø«Ù„ Ù…Ø­Ù„ Ø°Ø®ÛŒØ±Ù‡</span>
                <input type="text" id="inventory-notes" placeholder="Ù…Ø«Ø§Ù„: Ø§Ù†Ø¨Ø§Ø± Ø´Ù…Ø§Ø±Ù‡ 1">
            </div>
            <button class="submit-btn" onclick="submitInventory()">Ø«Ø¨Øª Ù…ÙˆØ¬ÙˆØ¯ÛŒ</button>
        </div>

        <!-- ÙØ±Ù… ÙˆØ§Ù… -->
        <div id="debt" class="tabcontent">
            <div class="form-group">
                <label for="debt-amount">Ù…Ø¨Ù„Øº ÙˆØ§Ù… (Ø±ÛŒØ§Ù„ØŒ Ø§Ø¬Ø¨Ø§Ø±ÛŒ):</label>
                <span class="tooltip">Ù…Ø¨Ù„Øº ÙˆØ§Ù… Ø¯Ø±ÛŒØ§ÙØªÛŒ</span>
                <input type="number" id="debt-amount" min="0" placeholder="Ù…Ø«Ø§Ù„: 10000000" required>
            </div>
            <div class="form-group">
                <label for="debt-interest">Ù†Ø±Ø® Ø¨Ù‡Ø±Ù‡ (%) (Ø§Ø®ØªÛŒØ§Ø±ÛŒ):</label>
                <span class="tooltip">Ù†Ø±Ø® Ø¨Ù‡Ø±Ù‡ Ø³Ø§Ù„ÛŒØ§Ù†Ù‡</span>
                <input type="number" id="debt-interest" min="0" step="0.1" placeholder="Ù…Ø«Ø§Ù„: 5">
            </div>
            <div class="form-group">
                <label for="debt-due">Ø³Ø±Ø±Ø³ÛŒØ¯ (Ø§Ø®ØªÛŒØ§Ø±ÛŒ):</label>
                <span class="tooltip">ØªØ§Ø±ÛŒØ® Ø¨Ø§Ø²Ù¾Ø±Ø¯Ø§Ø®Øª</span>
                <input type="date" id="debt-due">
            </div>
            <div class="form-group">
                <label for="debt-notes">ÛŒØ§Ø¯Ø¯Ø§Ø´Øª (Ø§Ø®ØªÛŒØ§Ø±ÛŒ):</label>
                <span class="tooltip">ØªÙˆØ¶ÛŒØ­Ø§Øª Ù…Ø«Ù„ Ù†Ø§Ù… Ø¨Ø§Ù†Ú©</span>
                <input type="text" id="debt-notes" placeholder="Ù…Ø«Ø§Ù„: ÙˆØ§Ù… Ø§Ø² Ø¨Ø§Ù†Ú© Ú©Ø´Ø§ÙˆØ±Ø²ÛŒ">
            </div>
            <button class="submit-btn" onclick="submitDebt()">Ø«Ø¨Øª ÙˆØ§Ù…</button>
        </div>

        <!-- Ú¯Ø²Ø§Ø±Ø´â€ŒÙ‡Ø§ -->
        <div id="reports" class="tabcontent">
            <h2>Ú¯Ø²Ø§Ø±Ø´â€ŒÙ‡Ø§ÛŒ Ù…Ø§Ù„ÛŒ</h2>
            <button class="report-btn" onclick="generateBalanceSheet()">ØªØ±Ø§Ø²Ù†Ø§Ù…Ù‡</button>
            <button class="report-btn" onclick="generateIncomeStatement()">ØµÙˆØ±Øª Ø³ÙˆØ¯ Ùˆ Ø²ÛŒØ§Ù†</button>
            <button class="report-btn" onclick="generateCashFlow()">ØµÙˆØ±Øª Ø¬Ø±ÛŒØ§Ù† Ù†Ù‚Ø¯ÛŒ</button>
            <button class="report-btn" onclick="generateTaxReport()">Ú¯Ø²Ø§Ø±Ø´ Ù…Ø§Ù„ÛŒØ§ØªÛŒ</button>
            <button class="report-btn" onclick="generateProductProfit()">Ø³ÙˆØ¯Ø¢ÙˆØ±ÛŒ Ù…Ø­ØµÙˆÙ„Ø§Øª</button>
            <button class="report-btn" onclick="predictNextThreeMonths()">Ù¾ÛŒØ´â€ŒØ¨ÛŒÙ†ÛŒ 3 Ù…Ø§Ù‡</button>
            <button class="report-btn" onclick="exportReport()">ØµØ§Ø¯Ø± Ú©Ø±Ø¯Ù† Ú¯Ø²Ø§Ø±Ø´</button>
            <div id="result"></div>
            <div id="chart-container"></div>
        </div>

        <!-- ØªÙ‚ÙˆÛŒÙ… Ù…Ø§Ù„ÛŒ -->
        <div id="calendar" class="tabcontent">
            <h2>ØªÙ‚ÙˆÛŒÙ… Ù…Ø§Ù„ÛŒ</h2>
            <div id="calendar-content"></div>
        </div>

        <div class="loader" id="loader">Ø¯Ø± Ø­Ø§Ù„ Ù¾Ø±Ø¯Ø§Ø²Ø´...</div>
        <div id="history">
            <h2>ØªØ§Ø±ÛŒØ®Ú†Ù‡ ØªØ±Ø§Ú©Ù†Ø´â€ŒÙ‡Ø§</h2>
            <div class="form-group">
                <label for="history-filter">ÙÛŒÙ„ØªØ±:</label>
                <select id="history-filter" onchange="displayHistory()">
                    <option value="all">Ù‡Ù…Ù‡</option>
                    <option value="income">Ø¯Ø±Ø¢Ù…Ø¯</option>
                    <option value="expense">Ù‡Ø²ÛŒÙ†Ù‡</option>
                    <option value="inventory">Ù…ÙˆØ¬ÙˆØ¯ÛŒ</option>
                    <option value="debt">ÙˆØ§Ù…</option>
                </select>
            </div>
            <div id="history-list"></div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script>
        // Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ù…Ø§Ù„ÛŒ
        const financialData = {
            income: [],
            expense: [],
            inventory: [],
            debt: [],
            balanceSheet: { assets: 0, liabilities: 0, equity: 0 }
        };

        // ØªØºÛŒÛŒØ± ØªÙ…
        function toggleDarkMode() {
            document.body.classList.toggle('dark-mode');
            localStorage.setItem('theme', document.body.classList.contains('dark-mode') ? 'dark' : 'light');
        }

        // Ù…Ø¯ÛŒØ±ÛŒØª ØªØ¨â€ŒÙ‡Ø§
        function openTab(evt, tabName) {
            document.querySelectorAll('.tabcontent').forEach(el => el.style.display = 'none');
            document.querySelectorAll('.tablinks').forEach(el => el.classList.remove('active'));
            document.getElementById(tabName).style.display = 'block';
            evt.currentTarget.classList.add('active');
            if (tabName === 'calendar') displayCalendar();
        }

        // Ø«Ø¨Øª Ø¯Ø±Ø¢Ù…Ø¯
        function submitIncome() {
            const loader = document.getElementById('loader');
            loader.style.display = 'block';
            setTimeout(() => {
                loader.style.display = 'none';
                processIncome();
            }, 500);
        }

        function processIncome() {
            const source = document.getElementById('income-source').value;
            const product = document.getElementById('income-product').value;
            const amount = document.getElementById('income-amount').value;
            const date = document.getElementById('income-date').value || new Date().toLocaleDateString('fa-IR');
            const recurring = document.getElementById('income-recurring').checked;
            const notes = document.getElementById('income-notes').value;
            const resultDiv = document.getElementById('result');

            if (!source || !amount) {
                resultDiv.innerHTML = '<p style="color: red;">Ù„Ø·ÙØ§Ù‹ Ù…Ù†Ø¨Ø¹ Ùˆ Ù…Ø¨Ù„Øº Ø¯Ø±Ø¢Ù…Ø¯ Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯.</p>';
                return;
            }

            const income = { source, product: product || 'Ù†Ø§Ù…Ø´Ø®Øµ', amount: parseFloat(amount), date, recurring, notes };
            financialData.income.push(income);
            financialData.balanceSheet.assets += parseFloat(amount);
            financialData.balanceSheet.equity += parseFloat(amount);
            saveData();
            updateDashboard();
            resultDiv.innerHTML = `<p style="color: green;">Ø¯Ø±Ø¢Ù…Ø¯ ${source} Ø¨Ø§ Ù…Ø¨Ù„Øº ${amount} Ø±ÛŒØ§Ù„ Ø«Ø¨Øª Ø´Ø¯.</p>`;
            displayHistory();
        }

        // Ø«Ø¨Øª Ù‡Ø²ÛŒÙ†Ù‡
        function submitExpense() {
            const loader = document.getElementById('loader');
            loader.style.display = 'block';
            setTimeout(() => {
                loader.style.display = 'none';
                processExpense();
            }, 500);
        }

        function processExpense() {
            const type = document.getElementById('expense-type').value;
            const product = document.getElementById('expense-product').value;
            const amount = document.getElementById('expense-amount').value;
            const date = document.getElementById('expense-date').value || new Date().toLocaleDateString('fa-IR');
            const recurring = document.getElementById('expense-recurring').checked;
            const notes = document.getElementById('expense-notes').value;
            const resultDiv = document.getElementById('result');

            if (!type || !amount) {
                resultDiv.innerHTML = '<p style="color: red;">Ù„Ø·ÙØ§Ù‹ Ù†ÙˆØ¹ Ùˆ Ù…Ø¨Ù„Øº Ù‡Ø²ÛŒÙ†Ù‡ Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯.</p>';
                return;
            }

            const expense = { type, product: product || 'Ù†Ø§Ù…Ø´Ø®Øµ', amount: parseFloat(amount), date, recurring, notes };
            financialData.expense.push(expense);
            financialData.balanceSheet.assets -= parseFloat(amount);
            financialData.balanceSheet.equity -= parseFloat(amount);
            saveData();
            updateDashboard();
            resultDiv.innerHTML = `<p style="color: green;">Ù‡Ø²ÛŒÙ†Ù‡ ${type} Ø¨Ø§ Ù…Ø¨Ù„Øº ${amount} Ø±ÛŒØ§Ù„ Ø«Ø¨Øª Ø´Ø¯.</p>`;
            displayHistory();
        }

        // Ø«Ø¨Øª Ù…ÙˆØ¬ÙˆØ¯ÛŒ
        function submitInventory() {
            const loader = document.getElementById('loader');
            loader.style.display = 'block';
            setTimeout(() => {
                loader.style.display = 'none';
                processInventory();
            }, 500);
        }

        function processInventory() {
            const type = document.getElementById('inventory-type').value;
            const quantity = document.getElementById('inventory-quantity').value;
            const unit = document.getElementById('inventory-unit').value || 'Ù†Ø§Ù…Ø´Ø®Øµ';
            const notes = document.getElementById('inventory-notes').value;
            const resultDiv = document.getElementById('result');

            if (!type || !quantity) {
                resultDiv.innerHTML = '<p style="color: red;">Ù„Ø·ÙØ§Ù‹ Ù†ÙˆØ¹ Ùˆ Ù…Ù‚Ø¯Ø§Ø± Ù…ÙˆØ¬ÙˆØ¯ÛŒ Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯.</p>';
                return;
            }

            const inventory = { type, quantity: parseFloat(quantity), unit, notes, date: new Date().toLocaleDateString('fa-IR') };
            financialData.inventory.push(inventory);
            saveData();
            updateDashboard();
            resultDiv.innerHTML = `<p style="color: green;">Ù…ÙˆØ¬ÙˆØ¯ÛŒ ${type} Ø¨Ø§ Ù…Ù‚Ø¯Ø§Ø± ${quantity} ${unit} Ø«Ø¨Øª Ø´Ø¯.</p>`;
            if (quantity < 10) {
                resultDiv.innerHTML += `<p style="color: red;">Ù‡Ø´Ø¯Ø§Ø±: Ù…ÙˆØ¬ÙˆØ¯ÛŒ ${type} Ú©Ù… Ø§Ø³Øª!</p>`;
            }
            displayHistory();
        }

        // Ø«Ø¨Øª ÙˆØ§Ù…
        function submitDebt() {
            const loader = document.getElementById('loader');
            loader.style.display = 'block';
            setTimeout(() => {
                loader.style.display = 'none';
                processDebt();
            }, 500);
        }

        function processDebt() {
            const amount = document.getElementById('debt-amount').value;
            const interest = document.getElementById('debt-interest').value || 0;
            const due = document.getElementById('debt-due').value || 'Ù†Ø§Ù…Ø´Ø®Øµ';
            const notes = document.getElementById('debt-notes').value;
            const resultDiv = document.getElementById('result');

            if (!amount) {
                resultDiv.innerHTML = '<p style="color: red;">Ù„Ø·ÙØ§Ù‹ Ù…Ø¨Ù„Øº ÙˆØ§Ù… Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯.</p>';
                return;
            }

            const debt = { amount: parseFloat(amount), interest: parseFloat(interest), due, notes, date: new Date().toLocaleDateString('fa-IR') };
            financialData.debt.push(debt);
            financialData.balanceSheet.assets += parseFloat(amount);
            financialData.balanceSheet.liabilities += parseFloat(amount);
            saveData();
            updateDashboard();
            resultDiv.innerHTML = `<p style="color: green;">ÙˆØ§Ù… Ø¨Ø§ Ù…Ø¨Ù„Øº ${amount} Ø±ÛŒØ§Ù„ Ø«Ø¨Øª Ø´Ø¯.</p>`;
            if (due && new Date(due) < new Date(new Date().setDate(new Date().getDate() + 7))) {
                resultDiv.innerHTML += `<p style="color: red;">Ù‡Ø´Ø¯Ø§Ø±: Ø³Ø±Ø±Ø³ÛŒØ¯ ÙˆØ§Ù… Ù†Ø²Ø¯ÛŒÚ© Ø§Ø³Øª!</p>`;
            }
            displayHistory();
        }

        // Ø°Ø®ÛŒØ±Ù‡ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§
        function saveData() {
            localStorage.setItem('financialData', JSON.stringify(financialData));
        }

        // Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ø¯Ø§Ø´Ø¨ÙˆØ±Ø¯
        function updateDashboard() {
            const totalIncome = financialData.income.reduce((sum, item) => sum + item.amount, 0);
            const totalExpense = financialData.expense.reduce((sum, item) => sum + item.amount, 0);
            const profit = totalIncome - totalExpense;
            const cashFlow = totalIncome - totalExpense;
            const totalInventory = financialData.inventory.reduce((sum, item) => sum + item.quantity, 0);
            document.getElementById('dashboard-profit').innerText = `Ø³ÙˆØ¯/Ø²ÛŒØ§Ù†: ${profit.toLocaleString('fa-IR')} Ø±ÛŒØ§Ù„`;
            document.getElementById('dashboard-cashflow').innerText = `Ø¬Ø±ÛŒØ§Ù† Ù†Ù‚Ø¯ÛŒ Ø®Ø§Ù„Øµ: ${cashFlow.toLocaleString('fa-IR')} Ø±ÛŒØ§Ù„`;
            document.getElementById('dashboard-inventory').innerText = `Ù…ÙˆØ¬ÙˆØ¯ÛŒ Ú©Ù„: ${totalInventory.toLocaleString('fa-IR')}`;
            if (cashFlow < 0) {
                document.getElementById('dashboard-cashflow').style.color = 'red';
            } else {
                document.getElementById('dashboard-cashflow').style.color = 'green';
            }
        }

        // Ù†Ù…Ø§ÛŒØ´ ØªØ§Ø±ÛŒØ®Ú†Ù‡
        function displayHistory() {
            const filter = document.getElementById('history-filter').value;
            const historyList = document.getElementById('history-list');
            historyList.innerHTML = '';
            if (filter === 'all' || filter === 'income') {
                financialData.income.forEach(item => {
                    historyList.innerHTML += `
                        <div class="history-item">
                            <p><strong>Ù†ÙˆØ¹:</strong> Ø¯Ø±Ø¢Ù…Ø¯ - ${item.source}</p>
                            <p><strong>Ù…Ø­ØµÙˆÙ„:</strong> ${item.product}</p>
                            <p><strong>Ù…Ø¨Ù„Øº:</strong> ${item.amount.toLocaleString('fa-IR')} Ø±ÛŒØ§Ù„</p>
                            <p><strong>ØªØ§Ø±ÛŒØ®:</strong> ${item.date}</p>
                            <p><strong>ØªÚ©Ø±Ø§Ø±Ø´ÙˆÙ†Ø¯Ù‡:</strong> ${item.recurring ? 'Ø¨Ù„Ù‡' : 'Ø®ÛŒØ±'}</p>
                            <p><strong>ÛŒØ§Ø¯Ø¯Ø§Ø´Øª:</strong> ${item.notes || 'Ù†Ø§Ù…Ø´Ø®Øµ'}</p>
                        </div>
                    `;
                });
            }
            if (filter === 'all' || filter === 'expense') {
                financialData.expense.forEach(item => {
                    historyList.innerHTML += `
                        <div class="history-item">
                            <p><strong>Ù†ÙˆØ¹:</strong> Ù‡Ø²ÛŒÙ†Ù‡ - ${item.type}</p>
                            <p><strong>Ù…Ø­ØµÙˆÙ„:</strong> ${item.product}</p>
                            <p><strong>Ù…Ø¨Ù„Øº:</strong> ${item.amount.toLocaleString('fa-IR')} Ø±ÛŒØ§Ù„</p>
                            <p><strong>ØªØ§Ø±ÛŒØ®:</strong> ${item.date}</p>
                            <p><strong>ØªÚ©Ø±Ø§Ø±Ø´ÙˆÙ†Ø¯Ù‡:</strong> ${item.recurring ? 'Ø¨Ù„Ù‡' : 'Ø®ÛŒØ±'}</p>
                            <p><strong>ÛŒØ§Ø¯Ø¯Ø§Ø´Øª:</strong> ${item.notes || 'Ù†Ø§Ù…Ø´Ø®Øµ'}</p>
                        </div>
                    `;
                });
            }
            if (filter === 'all' || filter === 'inventory') {
                financialData.inventory.forEach(item => {
                    historyList.innerHTML += `
                        <div class="history-item">
                            <p><strong>Ù†ÙˆØ¹:</strong> Ù…ÙˆØ¬ÙˆØ¯ÛŒ - ${item.type}</p>
                            <p><strong>Ù…Ù‚Ø¯Ø§Ø±:</strong> ${item.quantity.toLocaleString('fa-IR')} ${item.unit}</p>
                            <p><strong>ØªØ§Ø±ÛŒØ®:</strong> ${item.date}</p>
                            <p><strong>ÛŒØ§Ø¯Ø¯Ø§Ø´Øª:</strong> ${item.notes || 'Ù†Ø§Ù…Ø´Ø®Øµ'}</p>
                        </div>
                    `;
                });
            }
            if (filter === 'all' || filter === 'debt') {
                financialData.debt.forEach(item => {
                    historyList.innerHTML += `
                        <div class="history-item">
                            <p><strong>Ù†ÙˆØ¹:</strong> ÙˆØ§Ù…</p>
                            <p><strong>Ù…Ø¨Ù„Øº:</strong> ${item.amount.toLocaleString('fa-IR')} Ø±ÛŒØ§Ù„</p>
                            <p><strong>Ù†Ø±Ø® Ø¨Ù‡Ø±Ù‡:</strong> ${item.interest}%</p>
                            <p><strong>Ø³Ø±Ø±Ø³ÛŒØ¯:</strong> ${item.due}</p>
                            <p><strong>ØªØ§Ø±ÛŒØ®:</strong> ${item.date}</p>
                            <p><strong>ÛŒØ§Ø¯Ø¯Ø§Ø´Øª:</strong> ${item.notes || 'Ù†Ø§Ù…Ø´Ø®Øµ'}</p>
                        </div>
                    `;
                });
            }
        }

        // ØªÙˆÙ„ÛŒØ¯ ØªØ±Ø§Ø²Ù†Ø§Ù…Ù‡
        function generateBalanceSheet() {
            const resultDiv = document.getElementById('result');
            resultDiv.innerHTML = `
                <h3>ØªØ±Ø§Ø²Ù†Ø§Ù…Ù‡</h3>
                <p><strong>Ø¯Ø§Ø±Ø§ÛŒÛŒâ€ŒÙ‡Ø§:</strong> ${financialData.balanceSheet.assets.toLocaleString('fa-IR')} Ø±ÛŒØ§Ù„</p>
                <p><strong>Ø¨Ø¯Ù‡ÛŒâ€ŒÙ‡Ø§:</strong> ${financialData.balanceSheet.liabilities.toLocaleString('fa-IR')} Ø±ÛŒØ§Ù„</p>
                <p><strong>Ø­Ù‚ÙˆÙ‚ ØµØ§Ø­Ø¨Ø§Ù† Ø³Ù‡Ø§Ù…:</strong> ${financialData.balanceSheet.equity.toLocaleString('fa-IR')} Ø±ÛŒØ§Ù„</p>
            `;
            drawBalanceChart();
        }

        // ØªÙˆÙ„ÛŒØ¯ ØµÙˆØ±Øª Ø³ÙˆØ¯ Ùˆ Ø²ÛŒØ§Ù†
        function generateIncomeStatement() {
            const totalIncome = financialData.income.reduce((sum, item) => sum + item.amount, 0);
            const totalExpense = financialData.expense.reduce((sum, item) => sum + item.amount, 0);
            const profit = totalIncome - totalExpense;
            const resultDiv = document.getElementById('result');
            resultDiv.innerHTML = `
                <h3>ØµÙˆØ±Øª Ø³ÙˆØ¯ Ùˆ Ø²ÛŒØ§Ù†</h3>
                <p><strong>Ú©Ù„ Ø¯Ø±Ø¢Ù…Ø¯Ù‡Ø§:</strong> ${totalIncome.toLocaleString('fa-IR')} Ø±ÛŒØ§Ù„</p>
                <p><strong>Ú©Ù„ Ù‡Ø²ÛŒÙ†Ù‡â€ŒÙ‡Ø§:</strong> ${totalExpense.toLocaleString('fa-IR')} Ø±ÛŒØ§Ù„</p>
                <p><strong>Ø³ÙˆØ¯/Ø²ÛŒØ§Ù†:</strong> ${profit.toLocaleString('fa-IR')} Ø±ÛŒØ§Ù„</p>
            `;
            drawProfitChart(totalIncome, totalExpense, profit);
        }

        // ØªÙˆÙ„ÛŒØ¯ ØµÙˆØ±Øª Ø¬Ø±ÛŒØ§Ù† Ù†Ù‚Ø¯ÛŒ
        function generateCashFlow() {
            const totalIncome = financialData.income.reduce((sum, item) => sum + item.amount, 0);
            const totalExpense = financialData.expense.reduce((sum, item) => sum + item.amount, 0);
            const cashFlow = totalIncome - totalExpense;
            const resultDiv = document.getElementById('result');
            resultDiv.innerHTML = `
                <h3>ØµÙˆØ±Øª Ø¬Ø±ÛŒØ§Ù† Ù†Ù‚Ø¯ÛŒ</h3>
                <p><strong>Ø¬Ø±ÛŒØ§Ù† Ù†Ù‚Ø¯ÛŒ ÙˆØ±ÙˆØ¯ÛŒ:</strong> ${totalIncome.toLocaleString('fa-IR')} Ø±ÛŒØ§Ù„</p>
                <p><strong>Ø¬Ø±ÛŒØ§Ù† Ù†Ù‚Ø¯ÛŒ Ø®Ø±ÙˆØ¬ÛŒ:</strong> ${totalExpense.toLocaleString('fa-IR')} Ø±ÛŒØ§Ù„</p>
                <p><strong>Ø¬Ø±ÛŒØ§Ù† Ù†Ù‚Ø¯ÛŒ Ø®Ø§Ù„Øµ:</strong> ${cashFlow.toLocaleString('fa-IR')} Ø±ÛŒØ§Ù„</p>
                ${cashFlow < 0 ? '<p style="color: red;">Ù‡Ø´Ø¯Ø§Ø±: Ø¬Ø±ÛŒØ§Ù† Ù†Ù‚Ø¯ÛŒ Ù…Ù†ÙÛŒ Ø§Ø³Øª!</p>' : ''}
            `;
            drawCashFlowChart(totalIncome, totalExpense, cashFlow);
        }

        // ØªÙˆÙ„ÛŒØ¯ Ú¯Ø²Ø§Ø±Ø´ Ù…Ø§Ù„ÛŒØ§ØªÛŒ
        function generateTaxReport() {
            const taxableIncome = financialData.income.filter(item => item.source !== 'ÛŒØ§Ø±Ø§Ù†Ù‡ Ø¯ÙˆÙ„ØªÛŒ').reduce((sum, item) => sum + item.amount, 0);
            const deductibleExpenses = financialData.expense.filter(item => item.type !== 'Ù…Ø§Ù„ÛŒØ§Øª').reduce((sum, item) => sum + item.amount, 0);
            const resultDiv = document.getElementById('result');
            resultDiv.innerHTML = `
                <h3>Ú¯Ø²Ø§Ø±Ø´ Ù…Ø§Ù„ÛŒØ§ØªÛŒ</h3>
                <p><strong>Ø¯Ø±Ø¢Ù…Ø¯ Ù…Ø´Ù…ÙˆÙ„ Ù…Ø§Ù„ÛŒØ§Øª:</strong> ${taxableIncome.toLocaleString('fa-IR')} Ø±ÛŒØ§Ù„</p>
                <p><strong>Ù‡Ø²ÛŒÙ†Ù‡â€ŒÙ‡Ø§ÛŒ Ù‚Ø§Ø¨Ù„ Ú©Ø³Ø±:</strong> ${deductibleExpenses.toLocaleString('fa-IR')} Ø±ÛŒØ§Ù„</p>
                <p><strong>Ø³ÙˆØ¯ Ù…Ø´Ù…ÙˆÙ„ Ù…Ø§Ù„ÛŒØ§Øª:</strong> ${(taxableIncome - deductibleExpenses).toLocaleString('fa-IR')} Ø±ÛŒØ§Ù„</p>
                <p>ØªÙˆØµÛŒÙ‡: Ø§ÛŒÙ† Ú¯Ø²Ø§Ø±Ø´ Ø±Ø§ Ø¨Ù‡ Ø§Ø¯Ø§Ø±Ù‡ Ù…Ø§Ù„ÛŒØ§Øª Ø§Ø±Ø§Ø¦Ù‡ Ø¯Ù‡ÛŒØ¯.</p>
            `;
        }

        // ØªÙˆÙ„ÛŒØ¯ Ú¯Ø²Ø§Ø±Ø´ Ø³ÙˆØ¯Ø¢ÙˆØ±ÛŒ Ù…Ø­ØµÙˆÙ„Ø§Øª
        function generateProductProfit() {
            const products = [...new Set([...financialData.income.map(i => i.product), ...financialData.expense.map(e => e.product)])].filter(p => p !== 'Ù†Ø§Ù…Ø´Ø®Øµ');
            let resultHTML = '<h3>Ø³ÙˆØ¯Ø¢ÙˆØ±ÛŒ Ù…Ø­ØµÙˆÙ„Ø§Øª</h3>';
            products.forEach(product => {
                const productIncome = financialData.income.filter(i => i.product === product).reduce((sum, i) => sum + i.amount, 0);
                const productExpense = financialData.expense.filter(e => e.product === product).reduce((sum, e) => sum + e.amount, 0);
                const profit = productIncome - productExpense;
                resultHTML += `
                    <p><strong>${product}:</strong></p>
                    <p>Ø¯Ø±Ø¢Ù…Ø¯: ${productIncome.toLocaleString('fa-IR')} Ø±ÛŒØ§Ù„</p>
                    <p>Ù‡Ø²ÛŒÙ†Ù‡: ${productExpense.toLocaleString('fa-IR')} Ø±ÛŒØ§Ù„</p>
                    <p>Ø³ÙˆØ¯/Ø²ÛŒØ§Ù†: ${profit.toLocaleString('fa-IR')} Ø±ÛŒØ§Ù„</p>
                    ${profit < 0 ? '<p style="color: red;">Ù‡Ø´Ø¯Ø§Ø±: Ø§ÛŒÙ† Ù…Ø­ØµÙˆÙ„ Ø²ÛŒØ§Ù†â€ŒØ¯Ù‡ Ø§Ø³Øª!</p>' : ''}
                `;
            });
            document.getElementById('result').innerHTML = resultHTML;
            drawProductProfitChart(products);
        }

        // Ù¾ÛŒØ´â€ŒØ¨ÛŒÙ†ÛŒ 3 Ù…Ø§Ù‡ Ø¢ÛŒÙ†Ø¯Ù‡
        function predictNextThreeMonths() {
            const avgIncome = financialData.income.reduce((sum, item) => sum + item.amount, 0) / Math.max(1, financialData.income.length);
            const avgExpense = financialData.expense.reduce((sum, item) => sum + item.amount, 0) / Math.max(1, financialData.expense.length);
            const prediction = (avgIncome - avgExpense) * 3;
            document.getElementById('result').innerHTML = `
                <h3>Ù¾ÛŒØ´â€ŒØ¨ÛŒÙ†ÛŒ 3 Ù…Ø§Ù‡ Ø¢ÛŒÙ†Ø¯Ù‡</h3>
                <p><strong>Ø³ÙˆØ¯ Ø§Ø­ØªÙ…Ø§Ù„ÛŒ:</strong> ${prediction.toLocaleString('fa-IR')} Ø±ÛŒØ§Ù„</p>
                <p>Ø¨Ø± Ø§Ø³Ø§Ø³ Ù…ÛŒØ§Ù†Ú¯ÛŒÙ† Ø¯Ø±Ø¢Ù…Ø¯Ù‡Ø§ Ùˆ Ù‡Ø²ÛŒÙ†Ù‡â€ŒÙ‡Ø§ÛŒ ÙØ¹Ù„ÛŒ</p>
            `;
        }

        // ØµØ§Ø¯Ø± Ú©Ø±Ø¯Ù† Ú¯Ø²Ø§Ø±Ø´
        function exportReport() {
            const dataStr = JSON.stringify(financialData, null, 2);
            const blob = new Blob([dataStr], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const link = document.createElement('a');
            link.href = url;
            link.download = 'financial_report.json';
            link.click();
            URL.revokeObjectURL(url);
            document.getElementById('result').innerHTML = '<p style="color: green;">Ú¯Ø²Ø§Ø±Ø´ Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª ØµØ§Ø¯Ø± Ø´Ø¯.</p>';
        }

        // Ù†Ù…Ø§ÛŒØ´ ØªÙ‚ÙˆÛŒÙ… Ù…Ø§Ù„ÛŒ
        function displayCalendar() {
            const calendarContent = document.getElementById('calendar-content');
            let html = '<h3>Ø±ÙˆÛŒØ¯Ø§Ø¯Ù‡Ø§ÛŒ Ù…Ø§Ù„ÛŒ</h3>';
            financialData.debt.forEach(debt => {
                if (debt.due !== 'Ù†Ø§Ù…Ø´Ø®Øµ') {
                    html += `<p>Ø³Ø±Ø±Ø³ÛŒØ¯ ÙˆØ§Ù… ${debt.amount.toLocaleString('fa-IR')} Ø±ÛŒØ§Ù„: ${debt.due}</p>`;
                }
            });
            financialData.expense.forEach(expense => {
                if (expense.recurring) {
                    html += `<p>Ù‡Ø²ÛŒÙ†Ù‡ ØªÚ©Ø±Ø§Ø±Ø´ÙˆÙ†Ø¯Ù‡ ${expense.type} (${expense.amount.toLocaleString('fa-IR')} Ø±ÛŒØ§Ù„): Ù‡Ø± Ù…Ø§Ù‡</p>`;
                }
            });
            financialData.income.forEach(income => {
                if (income.recurring) {
                    html += `<p>Ø¯Ø±Ø¢Ù…Ø¯ ØªÚ©Ø±Ø§Ø±Ø´ÙˆÙ†Ø¯Ù‡ ${income.source} (${income.amount.toLocaleString('fa-IR')} Ø±ÛŒØ§Ù„): Ù‡Ø± Ù…Ø§Ù‡</p>`;
                }
            });
            calendarContent.innerHTML = html || '<p>Ù‡ÛŒÚ† Ø±ÙˆÛŒØ¯Ø§Ø¯ Ù…Ø§Ù„ÛŒ Ø«Ø¨Øª Ù†Ø´Ø¯Ù‡ Ø§Ø³Øª.</p>';
        }

        // Ù†Ù…ÙˆØ¯Ø§Ø± ØªØ±Ø§Ø²Ù†Ø§Ù…Ù‡
        function drawBalanceChart() {
            const chartContainer = document.getElementById('chart-container');
            chartContainer.innerHTML = '<canvas id="balanceChart"></canvas>';
            const ctx = document.getElementById('balanceChart').getContext('2d');
            new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: ['Ø¯Ø§Ø±Ø§ÛŒÛŒâ€ŒÙ‡Ø§', 'Ø¨Ø¯Ù‡ÛŒâ€ŒÙ‡Ø§', 'Ø­Ù‚ÙˆÙ‚ ØµØ§Ø­Ø¨Ø§Ù† Ø³Ù‡Ø§Ù…'],
                    datasets: [{
                        label: 'ØªØ±Ø§Ø²Ù†Ø§Ù…Ù‡',
                        data: [
                            financialData.balanceSheet.assets,
                            financialData.balanceSheet.liabilities,
                            financialData.balanceSheet.equity
                        ],
                        backgroundColor: ['#4CAF50', '#FF5722', '#2196F3'],
                        borderColor: ['#388E3C', '#D32F2F', '#1976D2'],
                        borderWidth: 1
                    }]
                },
                options: {
                    scales: { y: { beginAtZero: true, title: { display: true, text: 'Ù…Ø¨Ù„Øº (Ø±ÛŒØ§Ù„)' } } },
                    plugins: { title: { display: true, text: 'ØªØ±Ø§Ø²Ù†Ø§Ù…Ù‡ Ù…Ø§Ù„ÛŒ', font: { size: 18 } } }
                }
            });
        }

        // Ù†Ù…ÙˆØ¯Ø§Ø± Ø³ÙˆØ¯ Ùˆ Ø²ÛŒØ§Ù†
        function drawProfitChart(totalIncome, totalExpense, profit) {
            const chartContainer = document.getElementById('chart-container');
            chartContainer.innerHTML = '<canvas id="profitChart"></canvas>';
            const ctx = document.getElementById('profitChart').getContext('2d');
            new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: ['Ø¯Ø±Ø¢Ù…Ø¯Ù‡Ø§', 'Ù‡Ø²ÛŒÙ†Ù‡â€ŒÙ‡Ø§', 'Ø³ÙˆØ¯/Ø²ÛŒØ§Ù†'],
                    datasets: [{
                        label: 'ØµÙˆØ±Øª Ø³ÙˆØ¯ Ùˆ Ø²ÛŒØ§Ù†',
                        data: [totalIncome, totalExpense, profit],
                        backgroundColor: ['#4CAF50', '#FF5722', profit >= 0 ? '#2196F3' : '#F44336'],
                        borderColor: ['#388E3C', '#D32F2F', profit >= 0 ? '#1976D2' : '#D32F2F'],
                        borderWidth: 1
                    }]
                },
                options: {
                    scales: { y: { beginAtZero: true, title: { display: true, text: 'Ù…Ø¨Ù„Øº (Ø±ÛŒØ§Ù„)' } } },
                    plugins: { title: { display: true, text: 'ØµÙˆØ±Øª Ø³ÙˆØ¯ Ùˆ Ø²ÛŒØ§Ù†', font: { size: 18 } } }
                }
            });
        }

        // Ù†Ù…ÙˆØ¯Ø§Ø± Ø¬Ø±ÛŒØ§Ù† Ù†Ù‚Ø¯ÛŒ
        function drawCashFlowChart(totalIncome, totalExpense, cashFlow) {
            const chartContainer = document.getElementById('chart-container');
            chartContainer.innerHTML = '<canvas id="cashFlowChart"></canvas>';
            const ctx = document.getElementById('cashFlowChart').getContext('2d');
            new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: ['ÙˆØ±ÙˆØ¯ÛŒ Ù†Ù‚Ø¯ÛŒ', 'Ø®Ø±ÙˆØ¬ÛŒ Ù†Ù‚Ø¯ÛŒ', 'Ø¬Ø±ÛŒØ§Ù† Ù†Ù‚Ø¯ÛŒ Ø®Ø§Ù„Øµ'],
                    datasets: [{
                        label: 'ØµÙˆØ±Øª Ø¬Ø±ÛŒØ§Ù† Ù†Ù‚Ø¯ÛŒ',
                        data: [totalIncome, totalExpense, cashFlow],
                        backgroundColor: ['#4CAF50', '#FF5722', cashFlow >= 0 ? '#2196F3' : '#F44336'],
                        borderColor: ['#388E3C', '#D32F2F', cashFlow >= 0 ? '#1976D2' : '#D32F2F'],
                        borderWidth: 1
                    }]
                },
                options: {
                    scales: { y: { beginAtZero: true, title: { display: true, text: 'Ù…Ø¨Ù„Øº (Ø±ÛŒØ§Ù„)' } } },
                    plugins: { title: { display: true, text: 'ØµÙˆØ±Øª Ø¬Ø±ÛŒØ§Ù† Ù†Ù‚Ø¯ÛŒ', font: { size: 18 } } }
                }
            });
        }

        // Ù†Ù…ÙˆØ¯Ø§Ø± Ø³ÙˆØ¯Ø¢ÙˆØ±ÛŒ Ù…Ø­ØµÙˆÙ„Ø§Øª
        function drawProductProfitChart(products) {
            const chartContainer = document.getElementById('chart-container');
            chartContainer.innerHTML = '<canvas id="productProfitChart"></canvas>';
            const ctx = document.getElementById('productProfitChart').getContext('2d');
            const datasets = products.map(product => {
                const profit = financialData.income.filter(i => i.product === product).reduce((sum, i) => sum + i.amount, 0) -
                              financialData.expense.filter(e => e.product === product).reduce((sum, e) => sum + e.amount, 0);
                return profit;
            });
            new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: products,
                    datasets: [{
                        label: 'Ø³ÙˆØ¯/Ø²ÛŒØ§Ù† Ù…Ø­ØµÙˆÙ„Ø§Øª',
                        data: datasets,
                        backgroundColor: datasets.map(p => p >= 0 ? '#4CAF50' : '#F44336'),
                        borderColor: datasets.map(p => p >= 0 ? '#388E3C' : '#D32F2F'),
                        borderWidth: 1
                    }]
                },
                options: {
                    scales: { y: { title: { display: true, text: 'Ø³ÙˆØ¯/Ø²ÛŒØ§Ù† (Ø±ÛŒØ§Ù„)' } } },
                    plugins: { title: { display: true, text: 'Ø³ÙˆØ¯Ø¢ÙˆØ±ÛŒ Ù…Ø­ØµÙˆÙ„Ø§Øª', font: { size: 18 } } }
                }
            });
        }

        // Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ø§ÙˆÙ„ÛŒÙ‡
        document.addEventListener('DOMContentLoaded', () => {
            const savedData = JSON.parse(localStorage.getItem('financialData'));
            if (savedData) {
                financialData.income = savedData.income || [];
                financialData.expense = savedData.expense || [];
                financialData.inventory = savedData.inventory || [];
                financialData.debt = savedData.debt || [];
                financialData.balanceSheet = savedData.balanceSheet || { assets: 0, liabilities: 0, equity: 0 };
            }
            const savedTheme = localStorage.getItem('theme');
            if (savedTheme === 'dark') document.body.classList.add('dark-mode');
            updateDashboard();
            displayHistory();
            document.getElementsByClassName('tabcontent')[0].style.display = 'block';
        });
    </script>
</body>
</html>